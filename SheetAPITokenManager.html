<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: SheetAPITokenManager</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: SheetAPITokenManager</h1>

    




<section>

<header>
    
        <h2><span class="attribs"><span class="type-signature"></span></span>SheetAPITokenManager<span class="signature">(config)</span><span class="type-signature"></span></h2>
        
            <div class="class-description">The SheetAPITokenManager class is responsible for managing OAuth2 authentication tokensrequired to access the Google Sheets API. It supports both access tokens and refresh tokens,automatically refreshing expired tokens and providing callbacks for token updates.</div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    
    <h4 class="name" id="SheetAPITokenManager"><span class="type-signature"></span>new SheetAPITokenManager<span class="signature">(config)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Creates a new SheetAPITokenManager instance with comprehensive OAuth2 configuration.This constructor initializes the token manager with all necessary OAuth2 credentialsand configuration options. It validates that required parameters are provided andsets up the internal state for token management operations.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>config</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">Complete configuration object for OAuth2 setup
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>clientId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last">Google OAuth2 Client ID obtained from Google Cloud Console.                                  This is the public identifier for your OAuth2 application.                                  Required for all OAuth2 operations.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>clientSecret</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last">Google OAuth2 Client Secret obtained from Google Cloud Console.                                      This is the private key for your OAuth2 application.                                      Keep this secure and never expose in client-side code.                                      Required for token refresh operations.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>refreshToken</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last">Long-lived OAuth2 refresh token obtained during initial authorization.                                      This token allows indefinite access renewal without user interaction.                                      Store securely and never expose in client-side code.                                      Required for automatic token refresh.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>accessToken</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    null
                
                </td>
            

            <td class="description last">Current valid OAuth2 access token.                                            If provided, will be used until expiration.                                            Optional - will be obtained via refresh if not provided.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>expiryTime</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    0
                
                </td>
            

            <td class="description last">Timestamp (milliseconds since epoch) when the current access token expires.                                        Used to determine if token refresh is needed.                                        Optional - defaults to 0 (expired).</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>onTokenUpdate</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    null
                
                </td>
            

            <td class="description last">Callback function invoked whenever tokens are refreshed.                                                Receives an object with accessToken and expiryTime properties.                                                Useful for persisting tokens to localStorage, database, etc.                                                Optional - no callback if not provided.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>debug</code></td>
            

            <td class="type">
            
                
<span class="param-type">boolean</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    false
                
                </td>
            

            <td class="description last">Enables detailed debug logging for troubleshooting.                                        When true, logs all token operations, API calls, and state changes.                                        Optional - defaults to false for production use.</td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="SheetAPI.js.html">SheetAPI.js</a>, <a href="SheetAPI.js.html#line188">line 188</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>
<ul>
        <li>

<dl>
    <dt>
        <div class="param-desc">
        When required OAuth2 credentials are missing
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    
        <li>

<dl>
    <dt>
        <div class="param-desc">
        When token refresh fails after retries
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">Error</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>

</li>
    </ul>






    <h5>Examples</h5>
    
    <pre class="prettyprint"><code>// Basic usage with refresh tokenconst tokenManager = new SheetAPITokenManager({  clientId: 'your-client-id',  clientSecret: 'your-client-secret',  refreshToken: 'your-refresh-token',  onTokenUpdate: (tokens) => {    console.log('Tokens updated:', tokens);    // Save tokens to localStorage or database  },  debug: true});// Get a valid access tokenconst token = await tokenManager.getAccessToken();</code></pre>

    <pre class="prettyprint"><code>// Usage with existing access tokenconst tokenManager = new SheetAPITokenManager({  clientId: 'your-client-id',  clientSecret: 'your-client-secret',  refreshToken: 'your-refresh-token',  accessToken: 'existing-access-token',  expiryTime: Date.now() + 3600000, // Expires in 1 hour  debug: false});</code></pre>



    
    </div>

    

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="isTokenValid"><span class="type-signature"></span>isTokenValid<span class="signature">()</span><span class="type-signature"> &rarr; {boolean}</span></h4>
    

    



<div class="description">
    Check if current access token is still valid.Performs a comprehensive validation of the current access token to determineif it can be used for API calls without requiring a refresh. This methodimplements a proactive refresh strategy by considering tokens "expired"60 seconds before their actual expiry time to account for network latencyand processing delays.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="SheetAPI.js.html">SheetAPI.js</a>, <a href="SheetAPI.js.html#line324">line 324</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    True if the token is valid and can be used for API calls,                  false if the token is missing, expired, or about to expire.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>// Check token validity before making API callsif (tokenManager.isTokenValid()) {  console.log('Token is valid, proceeding with API call');  // Make API call with current token} else {  console.log('Token needs refresh');  // Token will be refreshed automatically by getAccessToken()}</code></pre>



        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="SheetAPI.html">SheetAPI</a></li><li><a href="SheetAPITokenManager.html">SheetAPITokenManager</a></li></ul><h3>Global</h3><ul><li><a href="global.html#create">create</a></li><li><a href="global.html#getAll">getAll</a></li><li><a href="global.html#getById">getById</a></li><li><a href="global.html#init">init</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Thu Nov 13 2025 03:00:18 GMT+0200 (South Africa Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>